"use strict";function UUIDjs(){}UUIDjs.maxFromBits=function(a){return Math.pow(2,a)},UUIDjs.limitUI04=UUIDjs.maxFromBits(4),UUIDjs.limitUI06=UUIDjs.maxFromBits(6),UUIDjs.limitUI08=UUIDjs.maxFromBits(8),UUIDjs.limitUI12=UUIDjs.maxFromBits(12),UUIDjs.limitUI14=UUIDjs.maxFromBits(14),UUIDjs.limitUI16=UUIDjs.maxFromBits(16),UUIDjs.limitUI32=UUIDjs.maxFromBits(32),UUIDjs.limitUI40=UUIDjs.maxFromBits(40),UUIDjs.limitUI48=UUIDjs.maxFromBits(48),UUIDjs.randomUI04=function(){return Math.round(Math.random()*UUIDjs.limitUI04)},UUIDjs.randomUI06=function(){return Math.round(Math.random()*UUIDjs.limitUI06)},UUIDjs.randomUI08=function(){return Math.round(Math.random()*UUIDjs.limitUI08)},UUIDjs.randomUI12=function(){return Math.round(Math.random()*UUIDjs.limitUI12)},UUIDjs.randomUI14=function(){return Math.round(Math.random()*UUIDjs.limitUI14)},UUIDjs.randomUI16=function(){return Math.round(Math.random()*UUIDjs.limitUI16)},UUIDjs.randomUI32=function(){return Math.round(Math.random()*UUIDjs.limitUI32)},UUIDjs.randomUI40=function(){return(0|Math.random()*(1<<30))+(0|1024*Math.random())*(1<<30)},UUIDjs.randomUI48=function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<18))*(1<<30)},UUIDjs.paddedString=function(a,b,c){a=String(a),c=c?c:"0";var d=b-a.length;for(d;d>0;d>>>=1,c+=c)1&d&&(a=c+a);return a},UUIDjs.prototype.fromParts=function(a,b,c,d,e,f){return this.version=c>>12&15,this.hex=UUIDjs.paddedString(a.toString(16),8)+"-"+UUIDjs.paddedString(b.toString(16),4)+"-"+UUIDjs.paddedString(c.toString(16),4)+"-"+UUIDjs.paddedString(d.toString(16),2)+UUIDjs.paddedString(e.toString(16),2)+"-"+UUIDjs.paddedString(f.toString(16),12),this},UUIDjs.prototype.toString=function(){return this.hex},UUIDjs.prototype.toURN=function(){return"urn:uuid:"+this.hex},UUIDjs.prototype.toBytes=function(){var a=this.hex.split("-"),b=[],c=0,d=0;for(d;d<a.length;d++){var e=0;for(e;e<a[d].length;e+=2)b[c++]=parseInt(a[d].substr(e,2),16)}return b},UUIDjs.prototype.equals=function(a){return a instanceof UUID?this.hex!==a.hex?!1:!0:!1},UUIDjs.getTimeFieldValues=function(a){var b=a-Date.UTC(1582,9,15),c=b/4294967296*1e4&268435455;return{low:1e4*(268435455&b)%4294967296,mid:65535&c,hi:c>>>16,timestamp:b}},UUIDjs._create4=function(){return(new UUIDjs).fromParts(UUIDjs.randomUI32(),UUIDjs.randomUI16(),16384|UUIDjs.randomUI12(),128|UUIDjs.randomUI06(),UUIDjs.randomUI08(),UUIDjs.randomUI48())},UUIDjs._create1=function(){var a=(new Date).getTime(),b=UUIDjs.randomUI14(),c=1099511627776*(1|UUIDjs.randomUI08())+UUIDjs.randomUI40(),d=UUIDjs.randomUI04(),e=0,f=.25;a!==e?(e>a&&b++,e=a,d=UUIDjs.randomUI04()):Math.random()<f&&9984>d?d+=1+UUIDjs.randomUI04():b++;var g=UUIDjs.getTimeFieldValues(e),h=g.low+d,i=4095&g.hi|4096;b&=16383;var j=b>>>8|128,k=255&b;return(new UUIDjs).fromParts(h,g.mid,i,j,k,c)},UUIDjs.create=function(a){return a=a||4,this["_create"+a]()},UUIDjs.fromTime=function(a,b){b=b?b:!1;var c=UUIDjs.getTimeFieldValues(a),d=c.low,e=4095&c.hi|4096;return b===!1?(new UUIDjs).fromParts(d,c.mid,e,0,0,0):(new UUIDjs).fromParts(d,c.mid,e,128|UUIDjs.limitUI06,UUIDjs.limitUI08-1,UUIDjs.limitUI48-1)},UUIDjs.firstFromTime=function(a){return UUIDjs.fromTime(a,!1)},UUIDjs.lastFromTime=function(a){return UUIDjs.fromTime(a,!0)},UUIDjs.fromURN=function(a){var b,c=/^(?:urn:uuid:|\{)?([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{2})([0-9a-f]{2})-([0-9a-f]{12})(?:\})?$/i;return b===c.exec(a)?(new UUIDjs).fromParts(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),parseInt(b[4],16),parseInt(b[5],16),parseInt(b[6],16)):null},UUIDjs.fromBytes=function(a){var b="",c=0,d=[4,2,2,2,6],e=0;if(a.length<5)return null;for(e;e<d.length;e++){var f=0;for(f;f<d[e];f++){var g=a[c++].toString(16);1===g.length&&(g="0"+g),b+=g}6!==d[e]&&(b+="-")}return UUIDjs.fromURN(b)},UUIDjs.fromBinary=function(a){var b=[],c=0;for(c;c<a.length;c++)if(b[c]=a.charCodeAt(c),b[c]>255||b[c]<0)throw new Error("Unexpected byte in binary data.");return UUIDjs.fromBytes(b)},function(a,b){var c=function(a){if("object"!=typeof a.document)throw new Error("Cookies.js requires a `window` with a `document` object");var c=function(a,b,d){return 1===arguments.length?c.get(a):c.set(a,b,d)};return c._document=a.document,c._cacheKeyPrefix="cookey.",c._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),c.defaults={path:"/",secure:!1},c.get=function(a){c._cachedDocumentCookie!==c._document.cookie&&c._renewCache();var d=c._cache[c._cacheKeyPrefix+a];return d===b?b:decodeURIComponent(d)},c.set=function(a,d,e){return e=c._getExtendedOptions(e),e.expires=c._getExpiresDate(d===b?-1:e.expires),c._document.cookie=c._generateCookieString(a,d,e),c},c.expire=function(a,d){return c.set(a,b,d)},c._getExtendedOptions=function(a){return{path:a&&a.path||c.defaults.path,domain:a&&a.domain||c.defaults.domain,expires:a&&a.expires||c.defaults.expires,secure:a&&a.secure!==b?a.secure:c.defaults.secure}},c._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())},c._getExpiresDate=function(a,b){if(b=b||new Date,"number"==typeof a?a=a===1/0?c._maxExpireDate:new Date(b.getTime()+1e3*a):"string"==typeof a&&(a=new Date(a)),a&&!c._isValidDate(a))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return a},c._generateCookieString=function(a,b,c){a=a.replace(/[^#$&+\^`|]/g,encodeURIComponent),a=a.replace(/\(/g,"%28").replace(/\)/g,"%29"),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),c=c||{};var d=a+"="+b;return d+=c.path?";path="+c.path:"",d+=c.domain?";domain="+c.domain:"",d+=c.expires?";expires="+c.expires.toUTCString():"",d+=c.secure?";secure":""},c._getCacheFromString=function(a){for(var d={},e=a?a.split("; "):[],f=0;f<e.length;f++){var g=c._getKeyValuePairFromCookieString(e[f]);d[c._cacheKeyPrefix+g.key]===b&&(d[c._cacheKeyPrefix+g.key]=g.value)}return d},c._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("=");b=0>b?a.length:b;var c,d=a.substr(0,b);try{c=decodeURIComponent(d)}catch(e){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+d+'"',e)}return{key:c,value:a.substr(b+1)}},c._renewCache=function(){c._cache=c._getCacheFromString(c._document.cookie),c._cachedDocumentCookie=c._document.cookie},c._areEnabled=function(){var a="cookies.js",b="1"===c.set(a,1).get(a);return c.expire(a),b},c.enabled=c._areEnabled(),c},d="object"==typeof a.document?c(a):c;"function"==typeof define&&define.amd?define(function(){return d}):"object"==typeof exports?("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=d),exports.Cookies=d):a.Cookies=d}("undefined"==typeof window?this:window),function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.store=b()}(this,function(){function a(){try{return f in d&&d[f]}catch(a){return!1}}var b,c={},d="undefined"!=typeof window?window:global,e=d.document,f="localStorage",g="script";if(c.disabled=!1,c.version="1.3.20",c.set=function(a,b){},c.get=function(a,b){},c.has=function(a){return void 0!==c.get(a)},c.remove=function(a){},c.clear=function(){},c.transact=function(a,b,d){null==d&&(d=b,b=null),null==b&&(b={});var e=c.get(a,b);d(e),c.set(a,e)},c.getAll=function(){},c.forEach=function(){},c.serialize=function(a){return JSON.stringify(a)},c.deserialize=function(a){if("string"!=typeof a)return void 0;try{return JSON.parse(a)}catch(b){return a||void 0}},a())b=d[f],c.set=function(a,d){return void 0===d?c.remove(a):(b.setItem(a,c.serialize(d)),d)},c.get=function(a,d){var e=c.deserialize(b.getItem(a));return void 0===e?d:e},c.remove=function(a){b.removeItem(a)},c.clear=function(){b.clear()},c.getAll=function(){var a={};return c.forEach(function(b,c){a[b]=c}),a},c.forEach=function(a){for(var d=0;d<b.length;d++){var e=b.key(d);a(e,c.get(e))}};else if(e&&e.documentElement.addBehavior){var h,i;try{i=new ActiveXObject("htmlfile"),i.open(),i.write("<"+g+">document.w=window</"+g+'><iframe src="/favicon.ico"></iframe>'),i.close(),h=i.w.frames[0].document,b=h.createElement("div")}catch(j){b=e.createElement("div"),h=e.body}var k=function(a){return function(){var d=Array.prototype.slice.call(arguments,0);d.unshift(b),h.appendChild(b),b.addBehavior("#default#userData"),b.load(f);var e=a.apply(c,d);return h.removeChild(b),e}},l=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),m=function(a){return a.replace(/^d/,"___$&").replace(l,"___")};c.set=k(function(a,b,d){return b=m(b),void 0===d?c.remove(b):(a.setAttribute(b,c.serialize(d)),a.save(f),d)}),c.get=k(function(a,b,d){b=m(b);var e=c.deserialize(a.getAttribute(b));return void 0===e?d:e}),c.remove=k(function(a,b){b=m(b),a.removeAttribute(b),a.save(f)}),c.clear=k(function(a){var b=a.XMLDocument.documentElement.attributes;a.load(f);for(var c=b.length-1;c>=0;c--)a.removeAttribute(b[c].name);a.save(f)}),c.getAll=function(a){var b={};return c.forEach(function(a,c){b[a]=c}),b},c.forEach=k(function(a,b){for(var d,e=a.XMLDocument.documentElement.attributes,f=0;d=e[f];++f)b(d.name,c.deserialize(a.getAttribute(d.name)))})}try{var n="__storejs__";c.set(n,n),c.get(n)!=n&&(c.disabled=!0),c.remove(n)}catch(j){c.disabled=!0}return c.enabled=!c.disabled,c}),function(a){window.namespace=function(a){for(var b,c=window,d=a.split(".");b=d.shift();)c[b]=c[b]||{},c=c[b]}}(window._),namespace("Dash.Browser"),function(){Dash.Browser.Location={change:function(a){window.location.replace(a)},hash:function(){return window.location.hash},reload:function(){window.location.reload()},changeHref:function(a){window.location.href=a}},Dash.Browser.Navigator={userAgent:function(){return window.navigator.userAgent}},Dash.Browser.changeTitle=function(a){document.title=a},Dash.Browser.open=function(a,b){return window.open(a,"_blank",b)},Dash.Browser.close=function(){window.close()},Dash.Browser.setTimeout=function(a,b){return window.setTimeout(a,b)},Dash.Browser.setInterval=function(a,b){return window.setInterval(a,b)},Dash.Browser.isInIframe=function(){try{return window.self!==window.top}catch(a){return!0}},Dash.Browser.isIFramedBy=function(a){return Dash.Browser.isInIframe()?window.top.location.origin===a:void 0},Dash.Browser.scrollToTop=function(){window.parent.postMessage("scrollTo:0",window.location.origin)},Dash.Browser.scrollToBottom=function(){console.log(document.body.scrollHeight),console.log($(document).height()),window.scrollTo(0,document.body.scrollHeight)}}(),namespace("Dash.OAuth"),function(a){Dash.OAuth.Cookie={set:function(b,c,d){a.set(b,c,d)},get:function(b){return a.get(b)},expire:function(b){a.expire(b)},isEnabled:function(){return a.enabled}}}(Cookies),namespace("Dash.OAuth"),function(){Dash.OAuth.LocalStorage={set:function(a,b,c){var d;c&&(d=60*c.expires),store.set(a,{value:b,expiresIn:d,createdAt:(new Date).getTime()})},get:function(a){var b=store.get(a),c=(new Date).getTime();return b?b.expiresIn&&c-b.createdAt>b.expiresIn?void this.expire(a):b.value:void 0},expire:function(a){store.remove(a)}}}(),namespace("Dash.OAuth"),namespace("Dash.OAuth.MemoryStorageData"),function(){Dash.OAuth.MemoryStorage={set:function(a,b,c){Dash.OAuth.MemoryStorageData[a]=b},get:function(a){return Dash.OAuth.MemoryStorageData[a]},expire:function(a){Dash.OAuth.MemoryStorageData[a]=void 0}}}(),namespace("Dash.OAuth"),function(){Dash.OAuth.Storage={names:{redirect:"DashOAuthRedirect",state:"DashOAuthState",token:"DashOAuthToken"},set:function(a,b,c){Dash.OAuth.MemoryStorage.set(a,b,c),Dash.OAuth.Cookie.set(a,b,c),Dash.OAuth.LocalStorage.set(a,b,c)},get:function(a){var b=Dash.OAuth.MemoryStorage.get(a);return void 0===b?Dash.OAuth.LocalStorage.get(a):(void 0===b&&(b=Dash.OAuth.Cookie.get(a)),b)},expire:function(a){Dash.OAuth.MemoryStorage.expire(a),Dash.OAuth.Cookie.expire(a),Dash.OAuth.LocalStorage.expire(a)}}}(),namespace("Dash.OAuth"),function(){Dash.OAuth.Params=function(a){this.queryString=a,this.queryStringToObject=function(){var a={},b=this.queryString.slice(1).split("&");return b.forEach(function(b){var c=b.split("=");a[c[0]]=c[1]}),a},this.get=function(a){return this.queryStringToObject()[a]}}}(),namespace("Dash.OAuth"),function(a,b){Dash.OAuth.UrlGenerator=function(c){this.baseUrl=c.baseUrl,this.clientId=c.clientId||"smi_platform",this.context=c.context,this.redirectUrl=c.redirectUrl,this.responseType=c.responseType,this.scopes=c.scopes,this.generate=function(){var c=a.create().hex,d=b.param({scope:this.scopes.join(" "),state:c,redirect_uri:this.redirectUrl,client_id:this.clientId,response_type:this.responseType,context:this.context});return{url:this.baseUrl+"?"+d,state:c}}}}(UUIDjs,jQuery),namespace("Dash.OAuth"),function(a){Dash.OAuth.TokenAccessor={set:function(b,c,d){d=parseInt(d),a.set(this.key(b),c,{expires:d}),null!==d?a.set(this.expiresInKey(b),this._futureUnixTime(d),{expires:d}):this.expireExpiresIn(b)},get:function(b){return a.get(this.key(b))},_futureUnixTime:function(a){var b=1e3*parseInt(a);return new Date(Date.now()+b).valueOf()},getExpiresIn:function(b){var c=parseInt(a.get(this.expiresInKey(b)));return isNaN(c)?1/0:(c-Date.now())/1e3},expire:function(b){a.expire(this.key(b)),this.expireExpiresIn(b)},expireExpiresIn:function(b){a.expire(this.expiresInKey(b))},prefix:"smi-access-token:",expiresInPrefix:"smi-access-token-expiration:",key:function(a){return""+this.prefix+a},expiresInKey:function(a){return""+this.expiresInPrefix+a},expireAll:function(a){var b=this;$.each(a,function(a,c){b.expire(c)})}}}(Dash.OAuth.Storage),namespace("Dash.OAuth"),function(){Dash.OAuth.TokenRefreshIframe=function(a){this.modalDataId="refresh-modal",this.$el=$('<iframe data-id="'+this.modalDataId+'" src="'+a+'"></iframe>'),this.render=function(){this.$el.hide(),$("body").append(this.$el)},this.remove=function(){this.$el.remove()}}}(),namespace("Dash.OAuth"),function(a){Dash.OAuth.TokenValidator=function(b,c,d){this.expiration=d,this.state=b,this.token=c,this.isValidState=function(b){return a.get(a.names.state)===this.state},this.storeToken=function(){return a.set(a.names.token,this.token,{expires:this.expiration})},this.removeToken=function(){return a.expire(a.names.token)},this.storedToken=function(){return a.get(a.names.token)},this.hasStoredToken=function(){return void 0!==a.get(a.names.token)}}}(Dash.OAuth.Storage),namespace("Dash.OAuth"),function(a,b){Dash.OAuth.AccessRequester=function(c){var d=300;this.urlGenerator=c,this.requestAccess=function(){var a=this.urlGenerator.generate();this.storeState(a.state),this.sendRequest(a.url)},this.storeState=function(b){a.set(a.names.state,b,{expires:d})},this.sendRequest=function(a){b.Location.change(a)}}}(Dash.OAuth.Storage,Dash.Browser),namespace("Dash.OAuth"),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};Dash.OAuth.AutoRefresh=function(){function b(b,c,d){this.appId=b,this.urlGenerator=c,this.shouldShowCallback=d,this.refreshLocation=a(this.refreshLocation,this)}return b.prototype.modalDataId="refresh-modal",b.prototype.checkForTokenInterval=200,b.prototype.maxWaitForToken=6e3,b.prototype.register=function(){var a,b,c=this;return a=Dash.OAuth.TokenAccessor.getExpiresIn(this.appId),b=1e3*a,this.timeoutId=Dash.Browser.setTimeout(function(){return c.trigger()},b),this.timeoutId},b.prototype.trigger=function(){return this.shouldShowModal()?(this.cleanUp(),this.renderModal()):void 0},b.prototype.renderModal=function(){var a=this;Dash.OAuth.TokenAccessor.expire(this.appId),Dash.OAuth.Storage.set("isAutoRefresh","true");var b=this.urlGenerator.generate();return(new Dash.OAuth.AccessRequester).storeState(b.state),this.modal=this.createModal(b.url),this.modal.render(),this.refreshPageTimeoutId=Dash.Browser.setTimeout(function(){a.refreshLocation(b.url)},this.maxWaitForToken),this.intervalId=Dash.Browser.setInterval(function(){return a.closeModal()},this.checkForTokenInterval),this.intervalId},b.prototype.createModal=function(a){return new Dash.OAuth.TokenRefreshIframe(a)},b.prototype.refreshLocation=function(a){return Dash.OAuth.AutoRefresh.expireFlag(),Dash.Browser.Location.change(a)},b.prototype.closeModal=function(){return void 0!==Dash.OAuth.TokenAccessor.get(this.appId)?(this.cleanUp(),this.register()):void 0},b.prototype.cleanUp=function(){var a;return clearTimeout(this.timeoutId),clearTimeout(this.refreshPageTimeoutId),clearInterval(this.intervalId),void 0!==(a=this.modal)?a.remove():void 0},b.prototype.shouldShowModal=function(){return void 0!==this.shouldShowCallback?this.shouldShowCallback():!0},b.expireFlag=function(){return Dash.OAuth.Storage.expire("isAutoRefresh")},b.isFlagSet=function(){return void 0!==Dash.OAuth.Storage.get("isAutoRefresh")},b}()}.call(this),namespace("Dash.OAuth"),function(){Dash.OAuth.Response=function(a){this.normalizedLocationHash=function(a){var b;return b=a.split("access_token="),2===b.length?"?access_token="+b[1]:a},this.removeLeadingSlash=function(a){return/^\//.test(a)?a.substr(1,a.length):a},this.params=new Dash.OAuth.Params(this.normalizedLocationHash(a)),this.token=function(){return this.params.get("access_token")},this.context=function(){return this.params.get("context")},this.expiresIn=function(){return this.params.get("expires_in")},this.isValidState=function(){var a,b,c;return b=this.params.get("state"),a=this.params.get("expires_in"),c=new Dash.OAuth.TokenValidator(b,this.token(),a),c.isValidState()}}}(),namespace("Dash"),function(a,b){Dash.Redirector=function(c){this.redirectUrl=c,this.register=function(){a.set("redirect-url",this.redirectUrl)},this.redirect=function(){var a=this.savedRedirectUrl();void 0!==a&&(b.changeHref(a),this.clearUrl())},this.savedRedirectUrl=function(){return a.get("redirect-url")},this.clearUrl=function(){a.expire("redirect-url")}}}(Dash.OAuth.TokenAccessor,Dash.Browser.Location);